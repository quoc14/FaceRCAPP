{% load index_filter %}

<!DOCTYPE html>
<html>
<head>
    <title>T·ªïng h·ª£p l·ªõp theo th√°ng</title>
</head>
<body>
    <h1>üìã T·ªïng h·ª£p l·ªõp theo th√°ng</h1>

    <form method="GET">
        <label>Ch·ªçn l·ªõp:</label>
        <select name="class_id">
            {% for cls in classes %}
                <option value="{{ cls.id }}" {% if cls.id == selected_class_id %}selected{% endif %}>{{ cls.name }}</option>
            {% endfor %}
        </select>

        <label>Ch·ªçn th√°ng:</label>
        <input type="text" name="month" value="{{ selected_month }}">
        <button type="submit">Xem</button>
    </form>

    <table border="1">
        <tr>
            <th>STT</th>
            <th>M√£ HS</th>
            <th>H·ªç t√™n</th>
            {% for header in column_headers %}
                <th>{{ header }} - BTVN</th>
                <th>{{ header }} - DD</th>
            {% endfor %}
            <th>KTT</th>
            <th>Voucher</th>
            <th>CC</th>
            <th>T·ªïng k·∫øt</th>
        </tr>

        {% for row in student_data %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ row.student.student_code }}</td>
            <td>{{ row.student.name }}</td>

            {% for s in row.scores %}
                <td>{{ s }}</td>
                <td>{{ row.attendances|index:forloop.counter0 }}</td>
            {% endfor %}

            <td>{{ row.summary.ktt_score|default:"" }}</td>
            <td>{{ row.summary.voucher_score|default:"" }}</td>
            <td>{{ row.summary.diligence_score|default:"" }}</td>
            <td>{{ row.summary.final_score|default:"" }}</td>
        </tr>
        {% endfor %}
    </table>
    <p><a href="{% url 'teacher_dashboard' %}">‚¨ÖÔ∏è Quay v·ªÅ Dashboard</a></p>
</body>
</html>
